<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クレイマー保有銘柄 | インタラクティブ米国株式市場見通し</title>
    <script src="https://cdn.tailwindcss.com/3.4.1"></script>
    <script>
        // index.htmlからTailwind CSSのカスタム設定を継承
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563EB',
                        secondary: '#DC2626',
                        bullish: '#10b981',
                        bearish: '#ef4444',
                        neutral: '#6b7280',
                    },
                    borderRadius: {
                        'none': '0px',
                        'sm': '4px',
                        DEFAULT: '8px',
                        'md': '12px',
                        'lg': '16px',
                        'xl': '20px',
                        '2xl': '24px',
                        '3xl': '32px',
                        'full': '9999px',
                        'button': '8px'
                    }
                }
            }
        }
    </script>
    <!-- Chart.jsは不要になったため削除 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
    <script src="translations/load.js"></script>
    <script src="lang.js"></script>
    <script src="stock-data-sync.js"></script>
    <script src="js/header-loader.js"></script>
    <style>
        /* index.htmlのスタイルを継承しつつ、このページ専用のスタイルを追加 */
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #f7f8fa; /* 背景色を少し明るく調整 */
        }
        .card {
            background-color: white;
            border-radius: 0.75rem; /* 12px */
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05), 0 2px 4px -2px rgba(0,0,0,0.05);
            transition: transform 0.3s, box-shadow 0.3s;
            overflow: hidden; /* カード内の要素がはみ出ないように */
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.07), 0 4px 6px -4px rgba(0,0,0,0.07);
        }
        .filter-button {
            transition: all 0.2s ease-in-out;
        }
        .filter-button.active {
            background-color: #2563EB; /* primary color */
            color: white;
            box-shadow: 0 4px 14px 0 rgba(37, 99, 235, 0.25);
        }
        .stock-tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem; /* 12px */
            font-weight: 500;
        }
    </style>
</head>
<body class="text-slate-700 min-h-screen">

<div id="header-container"></div>

<main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

    <!-- ページタイトルセクション -->
    <section class="text-center mb-12">
        <div class="mb-4">
            <img src="image/jim.png" alt="Jim Cramer" class="w-24 h-24 rounded-full object-cover mx-auto">
        </div>
        <h1 class="text-3xl md:text-4xl font-bold text-slate-800" data-lang="pickup_title">クレイマー保有銘柄</h1>
        <p class="text-slate-500 mt-4 max-w-2xl mx-auto">ジム・クレイマーの現在保有している銘柄群です。銘柄分析は「詳細を見る」から。</p>
    </section>

    <!-- フィルター＆ソート機能セクション -->
    <section class="mb-8 p-4 bg-white rounded-xl shadow-sm border border-gray-200 sticky top-0 z-40">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
            <!-- セクターフィルター -->
            <div class="flex-grow">
                <label class="text-sm font-medium text-slate-600 mb-2 block" data-lang="filter_sector">セクターで絞り込み</label>
                <div id="sector-filter" class="flex flex-wrap gap-2">
                    <button class="filter-button active px-4 py-2 text-sm font-semibold bg-gray-100 text-slate-700 rounded-full" data-sector="all" data-lang="filter_all">すべて</button>
                    <button class="filter-button px-4 py-2 text-sm font-semibold bg-gray-100 text-slate-700 rounded-full" data-sector="Technology" data-lang="sector_technology">テクノロジー</button>
                    <button class="filter-button px-4 py-2 text-sm font-semibold bg-gray-100 text-slate-700 rounded-full" data-sector="Healthcare" data-lang="sector_healthcare">ヘルスケア</button>
                    <button class="filter-button px-4 py-2 text-sm font-semibold bg-gray-100 text-slate-700 rounded-full" data-sector="Financials" data-lang="sector_financials">金融</button>
                    <button class="filter-button px-4 py-2 text-sm font-semibold bg-gray-100 text-slate-700 rounded-full" data-sector="Energy" data-lang="sector_energy">エネルギー</button>
                    <button class="filter-button px-4 py-2 text-sm font-semibold bg-gray-100 text-slate-700 rounded-full" data-sector="Consumer Discretionary">一般消費財</button>
                    <button class="filter-button px-4 py-2 text-sm font-semibold bg-gray-100 text-slate-700 rounded-full" data-sector="Industrials">資本財</button>
                </div>
            </div>
            <!-- ソート機能 -->
            <div class="flex-shrink-0">
                <label for="sort-by" class="text-sm font-medium text-slate-600 mb-2 block" data-lang="sort_by">並び替え</label>
                <select id="sort-by" class="w-full md:w-auto form-select appearance-none block px-3 py-2 text-base font-normal text-gray-700 bg-white bg-clip-padding bg-no-repeat border border-solid border-gray-300 rounded-lg transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-primary focus:outline-none">
                    <option value="marketCap_desc" data-lang="sort_marketcap_desc">時価総額 (大きい順)</option>
                    <option value="marketCap_asc" data-lang="sort_marketcap_asc">時価総額 (小さい順)</option>
                    <option value="performance_desc" data-lang="sort_performance_desc">パフォーマンス (良い順)</option>
                    <option value="performance_asc" data-lang="sort_performance_asc">パフォーマンス (悪い順)</option>
                </select>
            </div>
        </div>
    </section>

    <!-- 個別銘柄カードグリッド -->
    <section>
        <div id="stock-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
            <!-- JavaScriptによってここに銘柄カードが挿入されます -->
        </div>
        <div id="loading-indicator" class="text-center py-12 hidden">
             <p class="text-slate-500" data-lang="loading">データを読み込んでいます...</p>
        </div>
        <div id="no-results" class="text-center py-12 hidden">
             <p class="text-slate-500" data-lang="no_results">該当する銘柄が見つかりませんでした。</p>
        </div>
    </section>

</main>

<!-- index.htmlからフッターを継承 -->
<footer class="bg-slate-100 mt-12 border-t">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 text-center text-xs text-slate-500">
        <p>免責事項：本レポートは情報提供のみを目的としており、投資助言を構成するものではありません。投資に関する決定は、ご自身の判断と責任において行ってください。</p>
    </div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', async () => {
    // --- 言語システム初期化 ---
    if (typeof window.initLanguage === 'function') {
        await window.initLanguage();
    }

    // --- モバイルメニュー機能 (index.htmlから継承) ---
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    if (mobileMenuButton && mobileMenu) {
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
    }

    // --- 銘柄データ ---
    const allStockData = [
        {
            ticker: 'NVDA',
            name: 'NVIDIA Corp.',
            logo: 'https://placehold.co/40x40/76B900/FFFFFF?text=NVDA',
            sector: 'Technology',
            price: 120.78,
            change: 2.5,
            marketCap: 3.1, // Trillion
            peRatio: 70.5,
            performance: 150.2, // YTD
            summary: 'AIチップ市場の絶対的リーダー。データセンター向けGPUの需要は依然として旺盛で、今後の成長期待も非常に高い。',
            tags: ['AI', '半導体'],
            analystRating: { buy: 85, hold: 10, sell: 5 }
        },
        {
            ticker: 'MSFT',
            name: 'Microsoft Corp.',
            logo: 'https://placehold.co/40x40/F25022/FFFFFF?text=MSFT',
            sector: 'Technology',
            price: 445.12,
            change: -0.8,
            marketCap: 3.3, // Trillion
            peRatio: 38.6,
            performance: 18.5,
            summary: 'クラウドサービスAzureとAIアシスタントCopilotの連携が強力。エンタープライズ向けソフトウェア市場での地位は盤石。',
            tags: ['AI', 'クラウド', 'ソフトウェア'],
            analystRating: { buy: 88, hold: 12, sell: 0 }
        },
        {
            ticker: 'LLY',
            name: 'Eli Lilly and Co.',
            logo: 'https://placehold.co/40x40/FFBF3F/FFFFFF?text=LLY',
            sector: 'Healthcare',
            price: 890.10,
            change: 1.2,
            marketCap: 0.84, // Trillion
            peRatio: 125.8,
            performance: 52.1,
            summary: '肥満症治療薬「ゼップバウンド」と糖尿病治療薬「マンジャロ」が驚異的な成長を牽引。医薬品業界のゲームチェンジャー。',
            tags: ['医薬品', '肥満治療薬'],
            analystRating: { buy: 82, hold: 15, sell: 3 }
        },
        {
            ticker: 'AVGO',
            name: 'Broadcom Inc.',
            logo: 'https://placehold.co/40x40/E31837/FFFFFF?text=AVGO',
            sector: 'Technology',
            price: 1650.45,
            change: 3.1,
            marketCap: 0.77, // Trillion
            peRatio: 55.3,
            performance: 48.9,
            summary: 'AIインフラに不可欠なカスタムチップとネットワーク機器で高いシェア。VMware買収によるソフトウェア事業の強化も進む。',
            tags: ['半導体', 'AI', '5G'],
            analystRating: { buy: 79, hold: 18, sell: 3 }
        },
        {
            ticker: 'AAPL',
            name: 'Apple Inc.',
            logo: 'https://placehold.co/40x40/A3AAAE/FFFFFF?text=AAPL',
            sector: 'Technology',
            price: 215.05,
            change: 1.8,
            marketCap: 3.28,
            peRatio: 33.1,
            performance: 12.5,
            summary: 'iPhoneで世界を席巻する巨大IT企業。強力なブランド力とエコシステムを武器に、サービス部門も急成長中。',
            tags: ['スマートフォン', 'ブランド', 'サービス'],
            analystRating: { buy: 75, hold: 20, sell: 5 }
        },
        {
            ticker: 'AMZN',
            name: 'Amazon.com, Inc.',
            logo: 'https://placehold.co/40x40/FF9900/FFFFFF?text=AMZN',
            sector: 'Technology',
            price: 185.30,
            change: -0.5,
            marketCap: 1.93,
            peRatio: 51.2,
            performance: 22.1,
            summary: 'Eコマースとクラウド(AWS)の二大巨頭。広告事業の成長も著しく、AIへの投資も積極的に行っている。',
            tags: ['Eコマース', 'クラウド', '広告'],
            analystRating: { buy: 90, hold: 8, sell: 2 }
        },
        {
            ticker: 'COST',
            name: 'Costco Wholesale',
            logo: 'https://placehold.co/40x40/E31837/FFFFFF?text=COST',
            sector: 'Consumer Discretionary',
            price: 850.25,
            change: 0.9,
            marketCap: 0.37,
            peRatio: 51.5,
            performance: 28.4,
            summary: '会員制倉庫型小売の最大手。高い顧客ロイヤルティと効率的な経営で、不況下でも安定した業績を誇る。',
            tags: ['小売', '会員制', 'ディフェンシブ'],
            analystRating: { buy: 65, hold: 30, sell: 5 }
        },
        {
            ticker: 'META',
            name: 'Meta Platforms',
            logo: 'https://placehold.co/40x40/1877F2/FFFFFF?text=META',
            sector: 'Technology',
            price: 498.70,
            change: -1.2,
            marketCap: 1.26,
            peRatio: 27.3,
            performance: 40.9,
            summary: 'FacebookやInstagramを運営。デジタル広告市場での支配的な地位を背景に、メタバースとAIへの巨額投資を続ける。',
            tags: ['SNS', '広告', 'メタバース'],
            analystRating: { buy: 80, hold: 15, sell: 5 }
        },
        {
            ticker: 'WFC',
            name: 'Wells Fargo & Co.',
            logo: 'https://placehold.co/40x40/D71E28/FFFFFF?text=WFC',
            sector: 'Financials',
            price: 60.15,
            change: 0.3,
            marketCap: 0.21,
            peRatio: 11.8,
            performance: 22.3,
            summary: '米国の大手商業銀行。過去の問題から立ち直り、経営効率化を進めている。金利上昇局面で恩恵を受ける銘柄の一つ。',
            tags: ['銀行', '金融', 'バリュー株'],
            analystRating: { buy: 55, hold: 40, sell: 5 }
        },
        {
            ticker: 'ABT',
            name: 'Abbott Laboratories',
            logo: 'https://placehold.co/40x40/0096D6/FFFFFF?text=ABT',
            sector: 'Healthcare',
            price: 105.50,
            change: 0.7,
            marketCap: 0.18,
            peRatio: 33.2,
            performance: 2.1,
            summary: '医療機器、診断薬、栄養剤、ジェネリック医薬品などを幅広く手掛ける。安定した成長と配当が魅力。',
            tags: ['医療機器', 'ヘルスケア', '高配当'],
            analystRating: { buy: 70, hold: 25, sell: 5 }
        },
        {
            ticker: 'BLK',
            name: 'BlackRock, Inc.',
            logo: 'https://placehold.co/40x40/000000/FFFFFF?text=BLK',
            sector: 'Financials',
            price: 780.20,
            change: -1.5,
            marketCap: 0.11,
            peRatio: 20.1,
            performance: -2.5,
            summary: '世界最大の資産運用会社。iShares ETFブランドで市場をリード。金融市場の動向に大きく影響を受ける。',
            tags: ['資産運用', 'ETF', '金融'],
            analystRating: { buy: 60, hold: 35, sell: 5 }
        },
        {
            ticker: 'BMY',
            name: 'Bristol-Myers Squibb',
            logo: 'https://placehold.co/40x40/F17720/FFFFFF?text=BMY',
            sector: 'Healthcare',
            price: 42.10,
            change: 1.1,
            marketCap: 0.08,
            peRatio: 8.5,
            performance: -18.2,
            summary: 'がん、免疫、心血管疾患などの領域で革新的な医薬品を開発。主力製品の特許切れが課題だが、パイプラインに期待。',
            tags: ['製薬', 'がん治療', 'バリュー株'],
            analystRating: { buy: 40, hold: 50, sell: 10 }
        },
        {
            ticker: 'COF',
            name: 'Capital One Financial',
            logo: 'https://placehold.co/40x40/004977/FFFFFF?text=COF',
            sector: 'Financials',
            price: 140.80,
            change: 0.8,
            marketCap: 0.05,
            peRatio: 10.9,
            performance: 8.1,
            summary: 'クレジットカード事業を主力とする大手金融機関。消費者信用市場の動向に業績が左右される。',
            tags: ['クレジットカード', '金融', '消費者金融'],
            analystRating: { buy: 58, hold: 38, sell: 4 }
        },
        {
            ticker: 'CRM',
            name: 'Salesforce, Inc.',
            logo: 'https://placehold.co/40x40/00A1E0/FFFFFF?text=CRM',
            sector: 'Technology',
            price: 245.30,
            change: -2.1,
            marketCap: 0.24,
            peRatio: 45.6,
            performance: -6.8,
            summary: '顧客管理(CRM)ソフトウェアの世界的リーダー。AI機能「Einstein」を統合し、企業のデジタルトランスフォーメーションを支援。',
            tags: ['CRM', 'クラウド', 'SaaS'],
            analystRating: { buy: 81, hold: 17, sell: 2 }
        },
        {
            ticker: 'CRWD',
            name: 'CrowdStrike Holdings',
            logo: 'https://placehold.co/40x40/FF0000/FFFFFF?text=CRWD',
            sector: 'Technology',
            price: 380.90,
            change: 3.5,
            marketCap: 0.09,
            peRatio: 0, // N/A
            performance: 48.2,
            summary: 'クラウドベースのエンドポイントセキュリティを提供。サイバーセキュリティ需要の高まりを背景に急成長を遂げている。',
            tags: ['サイバーセキュリティ', 'クラウド', 'SaaS'],
            analystRating: { buy: 85, hold: 15, sell: 0 }
        },
        {
            ticker: 'CSCO',
            name: 'Cisco Systems',
            logo: 'https://placehold.co/40x40/1BA0D7/FFFFFF?text=CSCO',
            sector: 'Technology',
            price: 46.50,
            change: 0.2,
            marketCap: 0.19,
            peRatio: 14.1,
            performance: -8.1,
            summary: 'ネットワーク機器の最大手。ハードウェアからソフトウェア、セキュリティへと事業の軸足をシフトしている。',
            tags: ['ネットワーク', 'セキュリティ', '高配当'],
            analystRating: { buy: 45, hold: 50, sell: 5 }
        },
        {
            ticker: 'CTRA',
            name: 'Coterra Energy',
            logo: 'https://placehold.co/40x40/004B8D/FFFFFF?text=CTRA',
            sector: 'Energy',
            price: 28.10,
            change: -0.9,
            marketCap: 0.02,
            peRatio: 10.5,
            performance: 8.5,
            summary: '米国の独立系石油・天然ガス会社。天然ガス価格の動向が業績に大きく影響。株主還元に積極的。',
            tags: ['天然ガス', 'エネルギー', '高配当'],
            analystRating: { buy: 50, hold: 40, sell: 10 }
        },
        {
            ticker: 'DD',
            name: 'DuPont de Nemours',
            logo: 'https://placehold.co/40x40/E31837/FFFFFF?text=DD',
            sector: 'Industrials',
            price: 80.50,
            change: 1.3,
            marketCap: 0.03,
            peRatio: 18.2,
            performance: 5.6,
            summary: '特殊化学品メーカー。エレクトロニクス、自動車、建設など幅広い分野に素材を提供。景気動向に敏感。',
            tags: ['化学', '素材', '景気敏感株'],
            analystRating: { buy: 62, hold: 33, sell: 5 }
        },
        {
            ticker: 'DHR',
            name: 'Danaher Corporation',
            logo: 'https://placehold.co/40x40/00AEEF/FFFFFF?text=DHR',
            sector: 'Healthcare',
            price: 255.40,
            change: 0.6,
            marketCap: 0.19,
            peRatio: 35.1,
            performance: 10.2,
            summary: 'ライフサイエンス、診断、環境ソリューションなどを手掛ける複合企業。継続的なM&Aで成長を続ける。',
            tags: ['ライフサイエンス', 'ヘルスケア', 'M&A'],
            analystRating: { buy: 72, hold: 25, sell: 3 }
        },
        {
            ticker: 'DIS',
            name: 'The Walt Disney Co.',
            logo: 'https://placehold.co/40x40/1B2A7B/FFFFFF?text=DIS',
            sector: 'Consumer Discretionary',
            price: 102.30,
            change: -1.8,
            marketCap: 0.18,
            peRatio: 55.3,
            performance: 13.1,
            summary: '世界的なエンターテイメント企業。テーマパークの回復とストリーミング事業(Disney+)の収益性改善が課題。',
            tags: ['エンタメ', 'ストリーミング', 'テーマパーク'],
            analystRating: { buy: 50, hold: 40, sell: 10 }
        },
        {
            ticker: 'DOV',
            name: 'Dover Corporation',
            logo: 'https://placehold.co/40x40/004A99/FFFFFF?text=DOV',
            sector: 'Industrials',
            price: 185.60,
            change: 0.4,
            marketCap: 0.02,
            peRatio: 22.1,
            performance: 18.9,
            summary: '多角的な事業を持つ産業機械メーカー。幅広い最終市場に製品を提供しており、景気変動への耐性を持つ。',
            tags: ['産業機械', '資本財', '配当貴族'],
            analystRating: { buy: 60, hold: 35, sell: 5 }
        },
        {
            ticker: 'ETN',
            name: 'Eaton Corporation',
            logo: 'https://placehold.co/40x40/005EB8/FFFFFF?text=ETN',
            sector: 'Industrials',
            price: 325.80,
            change: 1.9,
            marketCap: 0.13,
            peRatio: 35.2,
            performance: 35.7,
            summary: '電力管理技術のリーダー。データセンター、EV、電力網の近代化といったメガトレンドの恩恵を受ける。',
            tags: ['電力管理', '電化', 'インフラ'],
            analystRating: { buy: 75, hold: 20, sell: 5 }
        },
        {
            ticker: 'GEV',
            name: 'GE Vernova',
            logo: 'https://placehold.co/40x40/00A79D/FFFFFF?text=GEV',
            sector: 'Industrials',
            price: 160.70,
            change: -0.5,
            marketCap: 0.04,
            peRatio: 0, // N/A
            performance: 25.1, // Since spin-off
            summary: 'GEからスピンオフしたエネルギー事業会社。発電、送配電、風力タービンなどを手掛け、エネルギー転換の中核を担う。',
            tags: ['エネルギー転換', '電力', '再生可能エネルギー'],
            analystRating: { buy: 55, hold: 40, sell: 5 }
        },
        {
            ticker: 'GS',
            name: 'Goldman Sachs',
            logo: 'https://placehold.co/40x40/7399C6/FFFFFF?text=GS',
            sector: 'Financials',
            price: 460.10,
            change: 1.4,
            marketCap: 0.15,
            peRatio: 17.5,
            performance: 20.8,
            summary: '世界有数の投資銀行。M&Aやトレーディング事業が好調。資産運用部門の強化も進めている。',
            tags: ['投資銀行', '金融', 'M&A'],
            analystRating: { buy: 65, hold: 30, sell: 5 }
        },
        {
            ticker: 'HD',
            name: 'The Home Depot',
            logo: 'https://placehold.co/40x40/F96302/FFFFFF?text=HD',
            sector: 'Consumer Discretionary',
            price: 350.40,
            change: -0.2,
            marketCap: 0.35,
            peRatio: 22.3,
            performance: 1.5,
            summary: '米国最大のホームセンター。住宅市場やリフォーム需要の動向が業績に影響。プロ向け顧客が強み。',
            tags: ['小売', '住宅', 'DIY'],
            analystRating: { buy: 60, hold: 35, sell: 5 }
        },
        {
            ticker: 'HON',
            name: 'Honeywell International',
            logo: 'https://placehold.co/40x40/ED1C24/FFFFFF?text=HON',
            sector: 'Industrials',
            price: 210.90,
            change: 0.9,
            marketCap: 0.14,
            peRatio: 23.8,
            performance: 1.2,
            summary: '航空宇宙、ビルディング技術、安全・生産性ソリューションなどを手掛ける複合企業。航空宇宙部門の回復が続く。',
            tags: ['航空宇宙', 'オートメーション', '複合企業'],
            analystRating: { buy: 68, hold: 28, sell: 4 }
        },
        {
            ticker: 'LIN',
            name: 'Linde plc',
            logo: 'https://placehold.co/40x40/005596/FFFFFF?text=LIN',
            sector: 'Industrials',
            price: 440.60,
            change: 1.1,
            marketCap: 0.21,
            peRatio: 32.7,
            performance: 7.3,
            summary: '世界最大の産業ガスメーカー。ヘルスケアからエレクトロニクスまで幅広い産業にガスを供給し、安定した需要を持つ。',
            tags: ['産業ガス', '化学', 'ディフェンシブ'],
            analystRating: { buy: 70, hold: 27, sell: 3 }
        },
        {
            ticker: 'PANW',
            name: 'Palo Alto Networks',
            logo: 'https://placehold.co/40x40/F15A29/FFFFFF?text=PANW',
            sector: 'Technology',
            price: 315.70,
            change: 2.8,
            marketCap: 0.10,
            peRatio: 45.9,
            performance: 7.1,
            summary: '次世代ファイアウォールで知られるサイバーセキュリティ大手。プラットフォーム化戦略で高成長を維持。',
            tags: ['サイバーセキュリティ', 'ネットワーク', 'クラウド'],
            analystRating: { buy: 83, hold: 15, sell: 2 }
        },
        {
            ticker: 'SBUX',
            name: 'Starbucks Corporation',
            logo: 'https://placehold.co/40x40/00704A/FFFFFF?text=SBUX',
            sector: 'Consumer Discretionary',
            price: 80.20,
            change: -1.3,
            marketCap: 0.09,
            peRatio: 22.1,
            performance: -15.8,
            summary: '世界最大のコーヒーチェーン。米国内での需要鈍化や労働問題が懸念材料だが、中国市場の回復に期待。',
            tags: ['カフェ', '外食', 'ブランド'],
            analystRating: { buy: 35, hold: 55, sell: 10 }
        },
        {
            ticker: 'TJX',
            name: 'The TJX Companies',
            logo: 'https://placehold.co/40x40/7C228A/FFFFFF?text=TJX',
            sector: 'Consumer Discretionary',
            price: 110.50,
            change: 0.7,
            marketCap: 0.12,
            peRatio: 25.3,
            performance: 18.1,
            summary: 'オフプライス小売の最大手。インフレ環境下で価格志向の消費者を惹きつけ、安定した業績を維持。',
            tags: ['小売', 'アパレル', 'ディスカウント'],
            analystRating: { buy: 70, hold: 25, sell: 5 }
        },
        {
            ticker: 'TXRH',
            name: 'Texas Roadhouse',
            logo: 'https://placehold.co/40x40/9E1B32/FFFFFF?text=TXRH',
            sector: 'Consumer Discretionary',
            price: 170.30,
            change: 1.6,
            marketCap: 0.01,
            peRatio: 33.8,
            performance: 30.5,
            summary: '手頃な価格のステーキで人気のレストランチェーン。力強い客足と効率的な店舗運営で成長を続ける。',
            tags: ['外食', 'レストラン', '消費者'],
            analystRating: { buy: 72, hold: 24, sell: 4 }
        }
    ];

    const stockGrid = document.getElementById('stock-grid');
    const sectorFilter = document.getElementById('sector-filter');
    const sortBySelect = document.getElementById('sort-by');
    const loadingIndicator = document.getElementById('loading-indicator');
    const noResults = document.getElementById('no-results');

    let currentFilter = 'all';
    let currentSort = 'marketCap_desc';

    // --- 「詳細を見る」ボタンのクリック処理 ---
    const handleStockDetailClick = (event) => {
        const ticker = event.target.getAttribute('data-ticker');
        
        // 銘柄別の詳細ページへの遷移
        const stockDetailPages = {
            'NVDA': 'stocks/details/nvidia.html',
            'MSFT': 'stocks/details/microsoft.html',
            'AAPL': 'stocks/details/apple.html',
            'LLY': 'stocks/details/lilly.html',
            'AVGO': 'stocks/details/avgo.html',
            'AMZN': 'stocks/details/amazon.html',
            'COST': 'stocks/details/cost.html',
            'META': 'stocks/details/meta.html',
            'WFC': 'stocks/details/wfc.html',
            'CRM': 'stocks/details/crm.html',
            'HD': 'stocks/details/hd.html',
            'CSCO': 'stocks/details/csco.html',
            'LIN': 'stocks/details/lin.html',
            'DHR': 'stocks/details/dhr.html',
            'ABT': 'stocks/details/abt.html',
            'DIS': 'stocks/details/dis.html',
            'GS': 'stocks/details/gs.html',
            'HON': 'stocks/details/hon.html',
            'ETN': 'stocks/details/etn.html',
            'TJX': 'stocks/details/tjx.html',
            'BLK': 'stocks/details/blk.html',
            'PANW': 'stocks/details/panw.html',
            'CRWD': 'stocks/details/crwd.html',
            'SBUX': 'stocks/details/sbux.html',
            'BMY': 'stocks/details/bmy.html',
            'COF': 'stocks/details/cof.html',
            'GEV': 'stocks/details/gev.html',
            'DD': 'stocks/details/dd.html',
            'CTRA': 'stocks/details/ctra.html',
            'DOV': 'stocks/details/dov.html',
            'TXRH': 'stocks/details/txrh.html'
        };
        
        const detailPage = stockDetailPages[ticker];
        if (detailPage) {
            window.location.href = detailPage;
        } else {
            // 詳細ページが未実装の銘柄の場合
            alert('この銘柄の詳細ページは現在準備中です。');
        }
    };

    // --- 銘柄カードをレンダリングする関数 ---
    const renderStockCards = (stocks) => {
        stockGrid.innerHTML = '';

        if (stocks.length === 0) {
            noResults.classList.remove('hidden');
            return;
        }
        noResults.classList.add('hidden');

        stocks.forEach((stock, index) => {
            const changeColor = stock.change >= 0 ? 'text-bullish' : 'text-bearish';
            const changeIcon = stock.change >= 0 ? 'ri-arrow-up-s-fill' : 'ri-arrow-down-s-fill';
            const card = document.createElement('div');
            card.className = 'card flex flex-col';
            card.innerHTML = `
                <div class="p-5 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-4">
                            <img src="${stock.logo}" alt="${stock.name} logo" class="w-10 h-10 rounded-full">
                            <div>
                                <h3 class="font-bold text-lg text-slate-800">${stock.name}</h3>
                                <p class="text-sm text-slate-500">${stock.ticker}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="font-semibold text-xl text-slate-900">$${stock.price.toFixed(2)}</p>
                            <p class="flex items-center justify-end text-sm font-medium ${changeColor}">
                                <i class="${changeIcon}"></i>
                                <span>${stock.change.toFixed(2)}%</span>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="p-5 flex-grow">
                    <p class="text-sm text-slate-600 mb-4 leading-relaxed">${stock.summary}</p>
                    <div class="flex flex-wrap gap-2 mb-4">
                        ${stock.tags.map(tag => `<span class="stock-tag bg-indigo-100 text-indigo-800">${tag}</span>`).join('')}
                    </div>
                    <div class="grid grid-cols-3 gap-4 text-center text-sm">
                        <div>
                            <p class="text-slate-500" data-lang="marketcap_label">時価総額</p>
                            <p class="font-semibold text-slate-800">${stock.marketCap.toFixed(2)}兆ドル</p>
                        </div>
                        <div>
                            <p class="text-slate-500" data-lang="per_label">PER</p>
                            <p class="font-semibold text-slate-800">${stock.peRatio ? stock.peRatio + '倍' : 'N/A'}</p>
                        </div>
                        <div>
                            <p class="text-slate-500" data-lang="ytd_performance_label">年初来</p>
                            <p class="font-semibold text-slate-800 ${stock.performance >= 0 ? 'text-bullish' : 'text-bearish'}">${stock.performance.toFixed(1)}%</p>
                        </div>
                    </div>
                </div>
                <div class="px-5 pb-5 mt-auto">
                    <!-- アナリスト評価セクション -->
                    <div class="mb-4 space-y-2">
                        <p class="text-sm font-medium text-slate-600">アナリスト評価</p>
                        <div class="space-y-1 text-xs">
                            <!-- Buy Rating -->
                            <div class="flex items-center">
                                <span class="w-10 text-slate-500">買い</span>
                                <div class="flex-1 bg-gray-200 rounded-full h-2 mx-2">
                                    <div class="bg-bullish h-2 rounded-full" style="width: ${stock.analystRating.buy}%"></div>
                                </div>
                                <span class="w-8 text-right font-medium text-slate-700">${stock.analystRating.buy}%</span>
                            </div>
                            <!-- Hold Rating -->
                            <div class="flex items-center">
                                <span class="w-10 text-slate-500">中立</span>
                                <div class="flex-1 bg-gray-200 rounded-full h-2 mx-2">
                                    <div class="bg-neutral h-2 rounded-full" style="width: ${stock.analystRating.hold}%"></div>
                                </div>
                                <span class="w-8 text-right font-medium text-slate-700">${stock.analystRating.hold}%</span>
                            </div>
                            <!-- Sell Rating -->
                            <div class="flex items-center">
                                <span class="w-10 text-slate-500">売り</span>
                                <div class="flex-1 bg-gray-200 rounded-full h-2 mx-2">
                                    <div class="bg-bearish h-2 rounded-full" style="width: ${stock.analystRating.sell}%"></div>
                                </div>
                                <span class="w-8 text-right font-medium text-slate-700">${stock.analystRating.sell}%</span>
                            </div>
                        </div>
                    </div>
                    <button class="stock-detail-btn w-full bg-primary text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors" data-ticker="${stock.ticker}" data-lang="view_details">
                        詳細を見る
                    </button>
                </div>
            `;
            stockGrid.appendChild(card);
        });

        // --- 言語システム再初期化（動的コンテンツ用） ---
        if (typeof window.updateLanguage === 'function') {
            window.updateLanguage();
        }

        // --- 「詳細を見る」ボタンのイベントハンドラーを設定 ---
        document.querySelectorAll('.stock-detail-btn').forEach(btn => {
            btn.addEventListener('click', handleStockDetailClick);
        });
    };

    // --- フィルターとソートを適用して再描画する関数 ---
    const applyFiltersAndSort = () => {
        loadingIndicator.classList.remove('hidden');
        stockGrid.innerHTML = '';
        noResults.classList.add('hidden');

        // 擬似的な遅延を加えてローディング感を演出
        setTimeout(() => {
            loadingIndicator.classList.add('hidden');
            let filteredStocks = allStockData;

            // フィルター適用
            if (currentFilter !== 'all') {
                filteredStocks = allStockData.filter(stock => stock.sector === currentFilter);
            }

            // ソート適用
            switch (currentSort) {
                case 'marketCap_desc':
                    filteredStocks.sort((a, b) => b.marketCap - a.marketCap);
                    break;
                case 'marketCap_asc':
                    filteredStocks.sort((a, b) => a.marketCap - b.marketCap);
                    break;
                case 'performance_desc':
                    filteredStocks.sort((a, b) => b.performance - a.performance);
                    break;
                case 'performance_asc':
                    filteredStocks.sort((a, b) => a.performance - b.performance);
                    break;
            }

            renderStockCards(filteredStocks);
        }, 500);
    };

    // --- イベントリスナーの設定 ---
    sectorFilter.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON') {
            currentFilter = e.target.dataset.sector;
            // アクティブなボタンのスタイルを更新
            sectorFilter.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            applyFiltersAndSort();
        }
    });

    sortBySelect.addEventListener('change', (e) => {
        currentSort = e.target.value;
        applyFiltersAndSort();
    });

    // --- 初期表示（同期処理より先に実行） ---
    applyFiltersAndSort();
    
    // --- バックグラウンドで株式データ同期実行 ---
    setTimeout(async () => {
        try {
            const stockSynchronizer = new StockDataSynchronizer();
            console.log('Starting background stock data synchronization...');
            await stockSynchronizer.syncAllStocks(allStockData);
            console.log('Background synchronization completed. Refreshing display...');
            
            // 同期後に表示を更新
            applyFiltersAndSort();
        } catch (error) {
            console.error('Background synchronization failed:', error);
        }
    }, 100);
});
</script>

</body>
</html>
